(()=>{"use strict";function e(){const e=document.querySelector(".clock");if(e){const t=new Date;e.textContent=t.toLocaleTimeString()}}function t(e){localStorage.setItem("columnSize",e);const t=document.querySelector(".columns");t&&(t.classList.forEach((e=>{e.startsWith("max-")&&t.classList.remove(e)})),"auto"!==e&&t.classList.add(e))}function n(e,n){let o=localStorage.getItem("columnSize"),l=n.indexOf(o);-1===l&&(l="next"===e?-1:0),"next"===e&&l<n.length-1?l+=1:"prev"===e&&l>0&&(l-=1),t(n[l])}function o(e){const t=document.querySelector(e);if(!t)return;let n=null;function o(e){n=this,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",this.outerHTML),this.classList.add("dragElem")}function l(e){return e.preventDefault&&e.preventDefault(),this.classList.add("over"),e.dataTransfer.dropEffect="move",!1}function a(){this.classList.add("over")}function c(){this.classList.remove("over")}function r(e){if(e.stopPropagation&&e.stopPropagation(),n!==this){const t=e.dataTransfer.getData("text/html"),o=document.createElement("div");o.innerHTML=t.trim();const l=o.firstChild,a=this.getBoundingClientRect();e.clientY-a.top>a.height/2?this.after(l):this.before(l),n.remove(),d(l)}return this.classList.remove("over"),!1}function s(){this.classList.remove("over"),this.classList.remove("dragElem")}function d(e){e.addEventListener("dragstart",o),e.addEventListener("dragenter",a),e.addEventListener("dragover",l),e.addEventListener("dragleave",c),e.addEventListener("drop",r),e.addEventListener("dragend",s)}Array.from(t.children).forEach(d)}function l(){const e=document.querySelector(".search-bar")?.value.toLowerCase()||"";document.querySelectorAll(".folders li").forEach((t=>{const n=t.textContent.toLowerCase();t.style.display=n.includes(e)?"":"none"}))}document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("restart-apache-button");e&&e.addEventListener("click",(()=>function(e){const t=document.getElementById("apache-status-message");t&&(t.innerText="Executing "+e+"...",fetch(`${window.BASE_URL}toggle_apache.php`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"action="+encodeURIComponent(e)}).then((e=>e.text())).then((e=>{try{const n=JSON.parse(e);t.innerText=n.message,"function"==typeof renderServerInfo&&renderServerInfo()}catch(n){console.error("Invalid JSON:",e),t.innerText="Error: Invalid server response"}})).catch((e=>{t.innerText="Error: "+e})))}("restart")))})),document.addEventListener("DOMContentLoaded",(()=>{e(),setInterval(e,1e3)})),function(){const e=["max-xs","max-sm","max-md","max-lg"];document.addEventListener("DOMContentLoaded",(()=>{const o=localStorage.getItem("columnSize");o&&t(o);const l=document.getElementById("reset-width"),a=document.getElementById("prev-width"),c=document.getElementById("next-width");l&&l.addEventListener("click",(()=>t("auto"))),a&&a.addEventListener("click",(()=>n("prev",e))),c&&c.addEventListener("click",(()=>n("next",e)))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".columns");if(!e)return;let t=null;const n=JSON.parse(localStorage.getItem("columnOrder")||"[]");n.length&&n.forEach((t=>{const n=document.getElementById(t);n&&e.appendChild(n)})),e.querySelectorAll(".column:not(.column-controls)").forEach((n=>{const o=n.querySelector(".drag-handle");o&&(n.setAttribute("draggable",!1),o.addEventListener("mousedown",(()=>{n.setAttribute("draggable",!0)})),o.addEventListener("mouseup",(()=>{n.setAttribute("draggable",!1)})),n.addEventListener("dragstart",(()=>{t=n,n.style.opacity="0.5"})),n.addEventListener("dragend",(()=>{t=null,n.style.opacity="1",n.setAttribute("draggable",!1),function(){const t=Array.from(e.children).filter((e=>!e.classList.contains("column-controls"))).map((e=>e.id));localStorage.setItem("columnOrder",JSON.stringify(t))}()})),n.addEventListener("dragover",(e=>e.preventDefault())),n.addEventListener("drop",(o=>{if(o.preventDefault(),t&&t!==n){const o=[...e.children],l=o.indexOf(n);o.indexOf(t)<l?n.after(t):n.before(t)}})))}))}))}(),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("dock-list"),t=document.getElementById("add-dock-item"),n=document.querySelector("#settings-view form");function l(t={}){const n=document.createElement("li");n.className="dock-item",n.draggable=!0,n.innerHTML=`\n                <input type="text" placeholder="Label" value="${t.label||""}">\n                <input type="text" placeholder="URL" value="${t.url||""}">\n                <input type="text" placeholder="Icon" value="${t.icon||""}">\n                <input type="text" placeholder="Alt Text" value="${t.alt||""}">\n                <button type="button" class="remove-dock-item">❌</button>\n            `,e.appendChild(n),n.querySelector(".remove-dock-item").addEventListener("click",(()=>{n.remove(),a()})),Array.from(n.querySelectorAll("input")).forEach((e=>{e.addEventListener("input",a)}))}function a(){const t=[];e.querySelectorAll(".dock-item").forEach((e=>{const n=e.querySelectorAll("input");t.push({label:n[0].value.trim(),url:n[1].value.trim(),icon:n[2].value.trim(),alt:n[3].value.trim()})}));const n=document.getElementById("dock_json_input");n&&(n.value=JSON.stringify(t,null,2))}e&&t&&n&&(fetch(`${window.BASE_URL}partials/dock.json`,{cache:"no-store"}).then((e=>e.json())).then((e=>{e.forEach(l),o("#dock-list"),a()})),t.addEventListener("click",(()=>{l(),o("#dock-list"),a()})))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("folders-config-list"),t=document.getElementById("add-folder-column"),n=document.getElementById("folders_json_input");function l(t={}){const n=document.createElement("li");n.className="folder-config-item",n.draggable=!0;const o=t.specialCases||{},l=Object.entries(o).map((([e,t])=>`\n                    <div class="special-case">\n                        <input type="text" class="case-key" placeholder="match" value="${e}">\n                        <input type="text" class="case-val" placeholder="replacement" value="${t}">\n                        <button type="button" class="remove-special">❌</button>\n                    </div>\n                `)).join("");n.innerHTML=`\n                <input type="text" placeholder="Title" value="${t.title||""}">\n                <input type="text" placeholder="Href (optional)" value="${t.href||""}">\n                <input type="text" placeholder="Dir (relative to HTDOCS_PATH)" value="${t.dir||""}">\n                <input type="text" placeholder="Exclude List (comma-separated)" value="${(t.excludeList||[]).join(",")}">\n                <input type="text" placeholder="Match Regex" value="${t.urlRules?.match||""}">\n                <input type="text" placeholder="Replace Regex" value="${t.urlRules?.replace||""}">\n                <label>Link Template:\n                  <select>\n                    <option value="basic" ${"basic"===t.linkTemplate?"selected":""}>basic</option>\n                    <option value="env-links" ${"env-links"===t.linkTemplate?"selected":""}>env-links</option>\n                    <option value="pantheon" ${"pantheon"===t.linkTemplate?"selected":""}>pantheon</option>\n                  </select>\n                </label>\n                <label><input type="checkbox" class="disable-links" ${t.disableLinks?"checked":""}> Disable Links</label>\n                <div class="special-cases-wrapper">\n                  <label>Special Cases:</label>\n                  <div class="special-cases">${l}</div>\n                  <button type="button" class="add-special">➕ Add Rule</button>\n                </div>\n                <button type="button" class="remove-folder-column">❌</button>\n            `,e.appendChild(n),n.querySelector(".remove-folder-column").addEventListener("click",(()=>{n.remove(),a()})),n.querySelector(".add-special").addEventListener("click",(()=>{const e=n.querySelector(".special-cases"),t=document.createElement("div");t.className="special-case",t.innerHTML='\n                    <input type="text" class="case-key" placeholder="match">\n                    <input type="text" class="case-val" placeholder="replacement">\n                    <button type="button" class="remove-special">❌</button>\n                ',e.appendChild(t),t.querySelector(".remove-special").addEventListener("click",(()=>{t.remove(),a()}))})),n.querySelectorAll(".remove-special").forEach((e=>e.addEventListener("click",(e=>{e.target.closest(".special-case").remove(),a()})))),Array.from(n.querySelectorAll("input, select")).forEach((e=>{e.addEventListener("input",a),e.addEventListener("change",a)}))}function a(){const t=[];e.querySelectorAll(".folder-config-item").forEach((e=>{const n=e.querySelectorAll("input"),o=e.querySelectorAll("select"),l=e.querySelectorAll(".special-case"),a={};l.forEach((e=>{const t=e.querySelector(".case-key").value.trim(),n=e.querySelector(".case-val").value.trim();t&&(a[t]=n)}));const c=e.querySelector(".disable-links")?.checked||!1;t.push({title:n[0].value.trim(),href:n[1].value.trim(),dir:n[2].value.trim(),excludeList:n[3].value.split(",").map((e=>e.trim())).filter(Boolean),urlRules:{match:n[4].value.trim(),replace:n[5].value.trim()},linkTemplate:o[0].value,disableLinks:c,specialCases:a})})),n.value=JSON.stringify(t,null,2)}e&&t&&n&&(fetch(`${window.BASE_URL}partials/folders.json`,{cache:"no-store"}).then((e=>e.json())).then((e=>{e.forEach((e=>l(e))),a(),o("#folders-config-list")})),t.addEventListener("click",(()=>{l(),a()})))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("link-templates-list"),t=document.getElementById("add-link-template");function n(){const t=[];e.querySelectorAll(".template-item").forEach((e=>{const n=e.querySelector(".template-name")?.value.trim(),o=e.querySelector(".template-html")?.value.trim();n&&o&&t.push({name:n,html:o})}));const n=document.getElementById("link_templates_json_input");n&&(n.value=JSON.stringify(t,null,2))}function o(t={}){const o=document.createElement("li");o.className="template-item",o.innerHTML=`\n        <input type="text" class="template-name" placeholder="Template Name" value="${t.name||""}">\n        <input type="text" class="template-html" placeholder="HTML Template" value="${t.html||""}">\n        <button type="button" class="remove-template">❌</button>\n      `,o.querySelector(".remove-template").addEventListener("click",(()=>{o.remove(),n()})),Array.from(o.querySelectorAll("input")).forEach((e=>{e.addEventListener("input",n)})),e.appendChild(o),n()}e&&t&&(t.addEventListener("click",(()=>o())),e.innerHTML="",fetch(`partials/link_templates.json?t=${Date.now()}`).then((e=>e.json())).then((e=>{e.forEach(o),n()})))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.body;if(!document.getElementById("error-log-section"))return;const t=document.getElementById("toggle-error-log"),n=document.getElementById("error-log");if(t.addEventListener("click",(function(){const e="block"===n.style.display;n.style.display=e?"none":"block",this.setAttribute("aria-expanded",!e)})),"true"!==e.getAttribute("data-ajax-enabled"))return;let o;function l(){fetch(`${window.BASE_URL}apache_error_log.php`,{cache:"no-store"}).then((e=>{if(!e.ok)throw new Error("Error log unavailable");return e.text()})).then((e=>{n.innerHTML=`<code>${e}</code>`}))}fetch(`${window.BASE_URL}apache_error_log.php`,{cache:"no-store"}).then((e=>{if(e.ok)return e.text()})).then((e=>{n.innerHTML=`<code>${e}</code>`,o=setInterval(l,3e3),l()})).catch((()=>{}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".search-bar");e&&e.addEventListener("input",l)})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("clear-local-storage");e&&e.addEventListener("click",(()=>{confirm("Are you sure you want to reset saved UI settings?")&&(Object.keys(localStorage).forEach((e=>{prefixesToRemove.some((t=>e.startsWith(t)))&&localStorage.removeItem(e)})),alert("Saved settings have been cleared from local storage."),location.reload())}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.body;if(!document.getElementById("system-monitor"))return;if("true"!==e.getAttribute("data-ajax-enabled"))return;const t=document.getElementById("cpu-load"),n=document.getElementById("memory-usage"),o=document.getElementById("disk-space");let l;function a(){fetch(`${window.BASE_URL}system_stats.php`,{cache:"no-store"}).then((e=>{if(!e.ok)throw new Error("System stats unavailable");return e.json()})).then((e=>{t.textContent=`${e.cpu}%`,n.textContent=`${e.memory} MB`,o.textContent=`${e.disk}%`}))}fetch(`${window.BASE_URL}system_stats.php`,{cache:"no-store"}).then((e=>{if(e.ok)return e.json()})).then((e=>{t.textContent=`${e.cpu}%`,n.textContent=`${e.memory} MB`,o.textContent=`${e.disk}%`,l=setInterval(a,1e3),a()})).catch((()=>{}))})),document.addEventListener("DOMContentLoaded",(()=>{"light"===localStorage.getItem("theme")&&(document.documentElement.classList.add("light-mode"),document.body.classList.add("light-mode"));const e=document.querySelector(".toggle-theme");e&&e.addEventListener("click",(()=>{document.documentElement.classList.toggle("light-mode"),document.body.classList.toggle("light-mode");const e=document.documentElement.classList.contains("light-mode");localStorage.setItem("theme",e?"light":"dark")}))})),document.addEventListener("DOMContentLoaded",(()=>{const e={index:document.getElementById("folders-view"),settings:document.getElementById("settings-view"),phpinfo:document.getElementById("phpinfo-view")};Object.entries({"toggle-index":"index","toggle-settings":"settings","toggle-phpinfo":"phpinfo"}).forEach((([t,n])=>{const o=document.getElementById(t);o&&o.addEventListener("click",(t=>{t.preventDefault(),Object.entries(e).forEach((([e,t])=>{t&&(t.style.display=e===n?"block":"none")}))}))}))}))})();
//# sourceMappingURL=script.min.js.map