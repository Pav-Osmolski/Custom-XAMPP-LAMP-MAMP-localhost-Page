(()=>{"use strict";function e(){const e=document.querySelector(".clock");if(e){const t=new Date;e.textContent=t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}}function t(e,t={}){const n=document.querySelector(e);if(!n)return;if("1"===n.dataset.sortBound)return;n.dataset.sortBound="1";const o=t.items||"li",a=t.handle||null;let r=null;n.addEventListener("pointerdown",e=>{const t=e.target.closest(o);t&&n.contains(t)&&(e.target.closest('input, select, textarea, button, a, [contenteditable=""], .no-drag')||a&&!e.target.closest(a)||(t.draggable=!0))},{capture:!0}),n.addEventListener("dragstart",e=>{const t=e.target.closest(o);if(t&&n.contains(t)){r=t,e.dataTransfer.effectAllowed="move";try{e.dataTransfer.setData("text/plain","")}catch(e){}t.classList.add("dragElem")}}),n.addEventListener("dragenter",e=>{const t=e.target.closest(o);t&&n.contains(t)&&t.classList.add("over")}),n.addEventListener("dragover",e=>{r&&e.preventDefault()}),n.addEventListener("dragleave",e=>{const t=e.target.closest(o);t&&n.contains(t)&&t.classList.remove("over")}),n.addEventListener("drop",e=>{e.preventDefault();const t=e.target.closest(o);if(!t||!r||t===r)return;const a=Array.from(n.querySelectorAll(`:scope > ${o}`)),l=a.indexOf(r),c=a.indexOf(t);l>-1&&c>-1&&(l<c?t.after(r):t.before(r),n.dispatchEvent(new CustomEvent("sorted",{bubbles:!0}))),t.classList.remove("over")}),n.addEventListener("dragend",e=>{const t=e.target.closest(o);t&&n.contains(t)&&(t.classList.remove("dragElem"),t.draggable=!1),Array.from(n.querySelectorAll(o)).forEach(e=>e.classList.remove("over")),r=null})}function n(e){localStorage.setItem("columnSize",e);const t=document.querySelector(".columns");t&&(t.classList.forEach(e=>{e.startsWith("max-")&&t.classList.remove(e)}),"auto"!==e&&t.classList.add(e))}function o(e,t){const o=localStorage.getItem("columnSize")||"auto",a=t.indexOf(o);let r=0;"next"===e?r=(a+1)%t.length:"prev"===e&&(r=(a-1+t.length)%t.length),n(t[r])}function a({sectionId:e,toggleButtonId:t,logElementId:n,endpoint:o}){document.addEventListener("DOMContentLoaded",()=>{const a=document.body;if(!document.getElementById(e))return;const r=document.getElementById(t),l=document.getElementById(n);function c(e){const t=""===e.trim();l.innerHTML=t?'<code class="muted">No errors logged. You\'re doing great. üéâ</code>':`<code>${e}</code>`}function s(){fetch(`${window.BASE_URL}${o}`,{cache:"no-store"}).then(e=>e.ok?e.text():Promise.reject()).then(c)}r&&l&&(r.addEventListener("click",function(){const e=l.classList.contains("visible");l.classList.toggle("visible",!e),this.setAttribute("aria-expanded",!e)}),"true"===a.getAttribute("data-ajax-enabled")&&fetch(`${window.BASE_URL}${o}`,{cache:"no-store"}).then(e=>e.ok?e.text():Promise.reject()).then(e=>{c(e),setInterval(s,3e3)}).catch(()=>{}))})}function r(){const e=document.getElementById("export-group"),t=document.getElementById("export-folder"),n=document.getElementById("uploads-mode-row"),o=document.getElementById("export-files-form"),a=document.getElementById("export-files-status"),r=document.getElementById("export-db-form"),l=document.getElementById("export-db"),c=document.getElementById("export-db-status");if(!e||!t)return;let s=[];function i(){return fetch(`${window.BASE_URL}partials/export.php?action=token`,{credentials:"same-origin"}).then(e=>e.json()).then(e=>{e.ok&&e.token&&document.querySelectorAll('input[name="csrf"]').forEach(t=>{t.value=e.token})}).catch(()=>{})}i(),fetch(`${window.BASE_URL}partials/export.php?action=scan`,{credentials:"same-origin"}).then(e=>e.json()).then(n=>{if(!n.ok)throw new Error(n.error||"Failed to scan folders");if(s=n.groups||[],!s.length){e.innerHTML='<option value="">No folders defined</option>',e.disabled=!0,t.innerHTML='<option value="">No subfolders</option>',t.disabled=!0;const n=document.getElementById("export-files-status");n&&(n.innerHTML="No folders defined. Add entries to <code>config/folders.json</code> to enable file exports.");const o=document.getElementById("uploads-mode-row");return void(o&&(o.style.display="none"))}!function(e,t){e.innerHTML="",t.forEach(t=>{const n=document.createElement("option");n.value=String(t.index),n.textContent=t.title,e.appendChild(n)})}(e,s),e.options.length&&e.dispatchEvent(new Event("change"))}).catch(n=>{console.error(n),e.innerHTML='<option value="">Error loading groups</option>',e.disabled=!0,t.innerHTML='<option value="">‚Äî</option>',t.disabled=!0}),fetch(`${window.BASE_URL}partials/export.php?action=dbs`,{credentials:"same-origin"}).then(e=>e.json()).then(e=>{if(!e.ok)throw new Error(e.error||"Failed to list databases");var t,n;t=l,n=e.databases||[],t.innerHTML="",n.length?n.forEach(e=>{const n=document.createElement("option");n.value=e,n.textContent=e,t.appendChild(n)}):t.innerHTML='<option value="">No databases found</option>'}).catch(e=>{console.error(e),l.innerHTML='<option value="">Error loading databases</option>'}),e.addEventListener("change",()=>{const o=parseInt(e.value,10),a=Number.isNaN(o)?null:s[o];t.disabled=!0,t.innerHTML='<option value="">Select a group first‚Ä¶</option>',n.style.display="none";const r=document.querySelector('input[name="uploadsMode"][value="exclude"]');var l,c;(r&&(r.checked=!0),a)&&(l=t,c=a.subfolders,l.innerHTML="",c.length?c.forEach(e=>{const t=document.createElement("option");t.value=e.name,t.textContent=e.name,l.appendChild(t)}):l.innerHTML='<option value="">No subfolders found</option>',t.disabled=0===a.subfolders.length,a.subfolders.length>0&&(t.selectedIndex=0,t.dispatchEvent(new Event("change"))))}),t.addEventListener("change",()=>{const o=parseInt(e.value,10),a=s[o];if(!a)return;const r=a.subfolders.find(e=>e.name===t.value),l=!!(r&&r.isWordPress&&r.hasUploads);n.style.display=l?"":"none";const c=document.querySelector('input[name="uploadsMode"][value="exclude"]');c&&(c.checked=!0)}),o.addEventListener("submit",e=>{e.preventDefault(),a.textContent="Preparing archive‚Ä¶";const t=new FormData(o);t.append("action","zip"),fetch(`${window.BASE_URL}partials/export.php`,{method:"POST",body:t,credentials:"same-origin"}).then(e=>e.json()).then(e=>{if(!e.ok)throw new Error(e.error||"Export failed");return a.innerHTML=`Done. <a href="${window.BASE_URL}${e.href}" download="${e.name}">${e.name}</a>`,window.location.href=`${window.BASE_URL}${e.href}`,i()}).catch(e=>(console.error(e),a.textContent="Error: "+e.message,i()))}),r.addEventListener("submit",e=>{e.preventDefault(),c.textContent="Dumping database‚Ä¶";const t=new FormData(r);t.append("action","dumpdb"),fetch(`${window.BASE_URL}partials/export.php`,{method:"POST",body:t,credentials:"same-origin"}).then(e=>e.json()).then(e=>{if(!e.ok)throw new Error(e.error||"DB export failed");return c.innerHTML=`Done. <a href="${window.BASE_URL}${e.href}" download="${e.name}">${e.name}</a>`,window.location.href=`${window.BASE_URL}${e.href}`,i()}).catch(e=>(console.error(e),c.textContent="Error: "+e.message,i()))})}function l(){const e=document.querySelector(".search-bar")?.value.toLowerCase()||"";document.querySelectorAll(".folders li").forEach(t=>{const n=t.textContent.toLowerCase();t.style.display=n.includes(e)?"":"none"})}function c(e){document.documentElement.className="","default"!==e&&document.documentElement.classList.add(`${e}-theme`),document.body.classList.remove("light-mode"),"undefined"!=typeof themeTypes&&"light"===themeTypes[e]&&document.body.classList.add("light-mode")}function s(){document.querySelectorAll("[data-generate-cert]").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.generateCert;confirm("Generate a new SSL certificate for "+t+"?")&&fetch(`${window.BASE_URL}utils/generate_cert.php?name=${encodeURIComponent(t)}`).then(e=>e.text()).then(e=>{if(alert(e),e.includes("successfully")){const e=document.getElementById("restart-apache");e&&e.click()}}).catch(()=>alert("Failed to run cert script."))})})}function i(){const e=document.getElementById("vhost-filter"),t=document.querySelectorAll("#vhosts-table tbody tr");e&&t.length&&e.addEventListener("change",()=>{const n=e.value;let o=0;t.forEach(e=>{const t=e.classList.contains("vhost-ssl"),a=e.classList.contains("cert-valid"),r=e.classList.contains("host-valid");let l=!0;"missing-cert"===n?l=!a:"missing-host"===n?l=!r:"ssl-only"===n?l=t:"non-ssl"===n&&(l=!t),e.style.display=l?"":"none",l&&o++});const a=document.getElementById("vhost-empty-msg");a&&(a.style.display=0===o?"":"none")})}function d(){document.addEventListener("click",e=>{if(e.target.matches(".open-folder")){const t=e.target.dataset.path.replace(/^"(.*)"$/,"$1");t&&fetch(`${window.BASE_URL}utils/open_folder.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:t})})}})}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("restart-apache-button");e&&e.addEventListener("click",()=>function(e){const t=document.getElementById("apache-status-message");t&&(t.innerText="Executing "+e+"...",fetch(`${window.BASE_URL}utils/toggle_apache.php`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"action="+encodeURIComponent(e)}).then(e=>e.text()).then(e=>{try{const n=JSON.parse(e);t.innerText=n.message,"function"==typeof renderServerInfo&&renderServerInfo()}catch(n){console.error("Invalid JSON:",e),t.innerText="Error: Invalid server response"}}).catch(e=>{t.innerText="Error: "+e}))}("restart"))}),document.addEventListener("DOMContentLoaded",()=>{e(),setInterval(e,1e3)}),document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".columns");if(!e)return;const a=["max-xs","max-sm","max-md","max-lg"],r=localStorage.getItem("columnSize");r&&a.includes(r)&&n(r);const l=document.getElementById("reset-width"),c=document.getElementById("prev-width"),s=document.getElementById("next-width");l&&l.addEventListener("click",()=>n("auto")),c&&c.addEventListener("click",()=>o("prev",a)),s&&s.addEventListener("click",()=>o("next",a));const i=JSON.parse(localStorage.getItem("columnOrder")||"[]");Array.isArray(i)&&i.length&&i.forEach(t=>{const n=document.getElementById(t);n&&n.classList.contains("column")&&!n.classList.contains("column-controls")&&e.appendChild(n)}),t(".columns",{items:".column:not(.column-controls)",handle:".drag-handle"}),e.addEventListener("sorted",function(){const t=Array.from(e.querySelectorAll(":scope > .column:not(.column-controls)")).map(e=>e.id).filter(Boolean);localStorage.setItem("columnOrder",JSON.stringify(t))})}),document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("dock-list"),n=document.getElementById("add-dock-item"),o=document.querySelector("#settings-view form");function a(t={}){const n=document.createElement("li");n.className="dock-item",n.innerHTML=`\n\t\t\t\t<input type="text" placeholder="Label" value="${t.label||""}">\n\t\t\t\t<input type="text" placeholder="URL" value="${t.url||""}">\n\t\t\t\t<input type="text" placeholder="Icon" value="${t.icon||""}">\n\t\t\t\t<input type="text" placeholder="Alt Text" value="${t.alt||""}">\n\t\t\t\t<button type="button" class="remove-dock-item">‚ùå</button>\n\t\t\t`,e.appendChild(n),n.querySelector(".remove-dock-item").addEventListener("click",()=>{n.remove(),r()}),Array.from(n.querySelectorAll("input")).forEach(e=>{e.addEventListener("input",r)})}function r(){const t=[];Array.from(e.children).forEach(e=>{const n=e.querySelectorAll("input");n.length<4||t.push({label:n[0].value.trim(),url:n[1].value.trim(),icon:n[2].value.trim(),alt:n[3].value.trim()})});const n=document.getElementById("dock_json_input");n&&(n.value=JSON.stringify(t,null,2))}e&&n&&o&&(fetch(`${window.BASE_URL}utils/read_config.php?file=dock`,{cache:"no-store"}).then(e=>e.json()).then(n=>{n.forEach(a),t("#dock-list"),e.addEventListener("sorted",r),r()}),n.addEventListener("click",()=>{a(),t("#dock-list"),r()}))}),document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("folders-config-list"),n=document.getElementById("add-folder-column"),o=document.getElementById("folders_json_input");if(!e||!n||!o)return;let a=[],r='<option value="">(none)</option>',l=!1,c=null;function s(e={}){return`\n\t\t\t\t<div class="special-case">\n\t\t\t\t\t<input type="text" class="sc-match" placeholder="Match Regex" value="${e.match||""}">\n\t\t\t\t\t<input type="text" class="sc-replace" placeholder="Replace Regex" value="${e.replace||""}">\n\t\t\t\t\t<button type="button" class="remove-special">‚úñ</button>\n\t\t\t\t</div>\n\t\t\t`}function i(e={}){const t=(n=e.specialCases,n&&"object"==typeof n&&!Array.isArray(n)?Object.entries(n).map(([e,t])=>({match:String(e??""),replace:String(t??"")})):[]).map(s).join("");var n;return e.linkTemplate,`\n\t\t\t\t<li class="folder-config-item">\n\t\t\t\t\t<input type="text" data-key="title" placeholder="Title" value="${e.title||""}">\n\t\t\t\t\t<input type="text" data-key="href" placeholder="Href (optional)" value="${e.href||""}">\n\t\t\t\t\t<input type="text" data-key="dir" placeholder="Dir (relative to HTDOCS_PATH)" value="${e.dir||""}">\n\t\t\t\t\t<input type="text" data-key="excludeList" placeholder="Exclude List (comma-separated)" value="${(e.excludeList||[]).join(",")}">\n\t\t\t\t\t<input type="text" data-key="match" placeholder="Match Regex" value="${e.urlRules?.match??""}">\n\t\t\t\t\t<input type="text" data-key="replace" placeholder="Replace Regex" value="${e.urlRules?.replace??""}">\n\t\t\t\t\t<label>Link Template:\n\t\t\t\t\t\t<select class="link-template-select" name="linkTemplate">${r}</select>\n\t\t\t\t\t</label>\n\t\t\t\t\t<label><input type="checkbox" class="disable-links"${e.disableLinks?" checked":""}> Disable Links</label>\n\n\t\t\t\t\t<div class="special-cases-wrapper">\n\t\t\t\t\t\t<label>Special Cases:</label>\n\t\t\t\t\t\t<div class="special-cases">${t}</div>\n\t\t\t\t\t\t<button type="button" class="add-special">‚ûï Add Rule</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<button type="button" class="remove-folder-column">‚ùå</button>\n\t\t\t\t</li>\n\t\t\t`}function d(t={}){const n=document.createElement("div");n.innerHTML=i(t);const o=n.firstElementChild;e.appendChild(o);const r=o.querySelector(".link-template-select");r&&(r.disabled=0===a.length,t.linkTemplate&&(r.value=t.linkTemplate)),u()}function u(){l=!0,c&&clearTimeout(c),c=setTimeout(m,120)}function m(){c=null,l&&(o.value=JSON.stringify(function(){const t=[];return e.querySelectorAll(".folder-config-item").forEach(e=>{const n=t=>e.querySelector(t),o=n('input[data-key="title"]')?.value.trim()||"",a=n('input[data-key="href"]')?.value.trim()||"",r=n('input[data-key="dir"]')?.value.trim()||"",l=n('input[data-key="excludeList"]')?.value||"",c=n('input[data-key="match"]')?.value||"",s=n('input[data-key="replace"]')?.value||"",i=e.querySelector(".link-template-select")?.value||"",d=!!e.querySelector(".disable-links")?.checked,u=[];e.querySelectorAll(".special-case").forEach(e=>{const t=e.querySelector(".sc-match")?.value||"",n=e.querySelector(".sc-replace")?.value||"";(t.length||n.length)&&u.push({match:t,replace:n})});const m=function(e){const t={};return e.forEach(({match:e="",replace:n=""})=>{const o=String(e).trim(),a=String(n).trim();(o.length||a.length)&&(t[o]=a)}),t}(u),p=l.split(",").map(e=>e.trim()).filter(Boolean),h={title:o,href:a,dir:r,excludeList:p,urlRules:{match:c,replace:s},linkTemplate:i,disableLinks:d,specialCases:m};(o||a||r||p.length||c||s||i||d||Object.keys(m).length)&&t.push(h)}),t}(),null,2),l=!1)}e.addEventListener("input",e=>{e.target.matches('input[type="text"], select')&&u()}),e.addEventListener("change",e=>{e.target.matches('select, input[type="checkbox"]')&&u()}),e.addEventListener("click",e=>{if(e.target.closest(".add-special")){const t=e.target.closest(".folder-config-item")?.querySelector(".special-cases");t&&(t.insertAdjacentHTML("beforeend",s()),u())}if(e.target.closest(".remove-special")){const t=e.target.closest(".special-case");t&&(t.remove(),u())}if(e.target.closest(".remove-folder-column")){const t=e.target.closest(".folder-config-item");t&&(t.remove(),u())}}),e.addEventListener("sorted",()=>{l=!0,m()}),Promise.all([fetch(`${window.BASE_URL}utils/read_config.php?file=folders`,{cache:"no-store"}).then(e=>e.json()).catch(()=>[]),Array.isArray(window.LINK_TEMPLATES)?(a=window.LINK_TEMPLATES.map(e=>e&&"string"==typeof e.name?e.name.trim():"").filter(Boolean),a=Array.from(new Set(a)),r='<option value="">(none)</option>'+a.map(e=>`<option value="${e}">${e}</option>`).join(""),Promise.resolve(a)):fetch(`${window.BASE_URL}utils/read_config.php?file=link_templates`,{cache:"no-store"}).then(e=>e.json()).then(e=>(a=(Array.isArray(e)?e:[]).map(e=>e&&"string"==typeof e.name?e.name.trim():"").filter(Boolean),a=Array.from(new Set(a)),r='<option value="">(none)</option>'+a.map(e=>`<option value="${e}">${e}</option>`).join(""),a)).catch(()=>(a=[],r='<option value="">(none)</option>',a))]).then(([n])=>{t("#folders-config-list"),Array.isArray(n)&&n.length&&function(t){const n=document.createDocumentFragment(),o=document.createElement("div");o.innerHTML=t.map(i).join(""),Array.from(o.children).forEach(e=>n.appendChild(e)),e.appendChild(n),e.querySelectorAll(".folder-config-item").forEach(e=>{const n=e.querySelector(".link-template-select");if(n){const o=e.querySelector('input[data-key="title"]')?.value||"",r=t.find(e=>(e.title||"")===o),l=r?.linkTemplate||"";l&&(n.value=l),n.disabled=0===a.length}})}(n),0===e.children.length&&d({}),l=!0,m()}),n.addEventListener("click",()=>{d({})})}),document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("link-templates-list"),t=document.getElementById("add-link-template");function n(){const t=[];e.querySelectorAll(".template-item").forEach(e=>{const n=e.querySelector(".template-name")?.value.trim(),o=e.querySelector(".template-html")?.value.trim();n&&o&&t.push({name:n,html:o})});const n=document.getElementById("link_templates_json_input");n&&(n.value=JSON.stringify(t,null,2))}function o(t={}){const o=document.createElement("li");o.className="template-item",o.innerHTML=`\n        <input type="text" class="template-name" placeholder="Template Name" value="${t.name||""}">\n        <input type="text" class="template-html" placeholder="HTML Template" value="${t.html||""}">\n        <button type="button" class="remove-template">‚ùå</button>\n      `,o.querySelector(".remove-template").addEventListener("click",()=>{o.remove(),n()}),Array.from(o.querySelectorAll("input")).forEach(e=>{e.addEventListener("input",n)}),e.appendChild(o),n()}e&&t&&(t.addEventListener("click",()=>o()),e.innerHTML="",fetch(`${window.BASE_URL}utils/read_config.php?file=link_templates`,{cache:"no-store"}).then(e=>e.json()).then(e=>{e.forEach(o),n()}))}),a({sectionId:"apache-error-log-section",toggleButtonId:"toggle-apache-error-log",logElementId:"apache-error-log",endpoint:"utils/apache_error_log.php"}),a({sectionId:"php-error-log-section",toggleButtonId:"toggle-php-error-log",logElementId:"php-error-log",endpoint:"utils/php_error_log.php"}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>r()):r(),document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".search-bar");e&&e.addEventListener("input",l)}),document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("clear-local-storage");e&&e.addEventListener("click",()=>{if(!confirm("Are you sure you want to reset saved UI settings?"))return;const e=["theme","columnOrder","columnSize"];Object.keys(localStorage).forEach(t=>{e.some(e=>t.startsWith(e))&&localStorage.removeItem(t)}),alert("Saved settings have been cleared from local storage."),location.reload()})}),document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".post-confirmation-container");e&&setTimeout(()=>{e.style.transition="opacity 0.5s ease",e.style.opacity="0",setTimeout(()=>e.remove(),500)},3e3)}),document.addEventListener("DOMContentLoaded",()=>{const e=document.body;if(!document.getElementById("system-monitor"))return;if("true"!==e.getAttribute("data-ajax-enabled"))return;const t=document.getElementById("cpu-load"),n=document.getElementById("memory-usage"),o=document.getElementById("disk-space");let a;function r(){fetch(`${window.BASE_URL}utils/system_stats.php`,{cache:"no-store"}).then(e=>{if(!e.ok)throw new Error("System stats unavailable");return e.json()}).then(e=>{t.textContent=`${e.cpu}%`,n.textContent=`${e.memory} MB`,o.textContent=`${e.disk}%`})}fetch(`${window.BASE_URL}utils/system_stats.php`,{cache:"no-store"}).then(e=>{if(e.ok)return e.json()}).then(e=>{t.textContent=`${e.cpu}%`,n.textContent=`${e.memory} MB`,o.textContent=`${e.disk}%`,a=setInterval(r,1e3),r()}).catch(()=>{})}),document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("#theme-selector");if(!e)return;const t=localStorage.getItem("theme")||serverTheme||"default";c(t),e.value=t,e.addEventListener("change",e=>{const t=e.target.value;c(t),localStorage.setItem("theme",t)})}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{s(),i(),d()}):(s(),i(),d()),document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".toggle-content-container").forEach((e,t)=>{const n=e.querySelector(".toggle-accordion"),o=e.querySelector(".toggle-content");if(!n||!o)return;const a=parseInt(o.dataset.collapsedHeight)||0,r=e.dataset.id||"accordion-"+t;"open"===localStorage.getItem("accordion_"+r)?(e.classList.add("open"),o.style.height=o.scrollHeight+"px",requestAnimationFrame(()=>{o.style.height="auto"})):(e.classList.remove("open"),o.style.height=a+"px"),n.addEventListener("click",t=>{if(t.stopPropagation(),function(e,t){return!!e.target.closest(t)}(t,".tooltip-icon"))return;const n=e.classList.toggle("open");if(localStorage.setItem("accordion_"+r,n?"open":"closed"),n){o.style.height=o.scrollHeight+"px";const e=()=>{o.style.height="auto",o.removeEventListener("transitionend",e)};o.addEventListener("transitionend",e)}else o.style.height=o.scrollHeight+"px",o.offsetHeight,requestAnimationFrame(()=>{o.style.height=a+"px"})})}),window.addEventListener("resize",()=>{document.querySelectorAll(".toggle-content-container.open .toggle-content").forEach(e=>{"auto"!==e.style.height&&(e.style.height=e.scrollHeight+"px")})})}),document.addEventListener("DOMContentLoaded",()=>{const e={index:document.getElementById("folders-view"),settings:document.getElementById("settings-view"),phpinfo:document.getElementById("phpinfo-view"),apache:document.getElementById("apache-view"),mysql:document.getElementById("mysql-view")},t={index:"index",settings:"settings",phpinfo:"phpinfo","apache-inspector":"apache","mysql-inspector":"mysql"};function n(){return new URLSearchParams(window.location.search).get("view")||"index"}function o(n,o=!1){const a=t[n]||"index";if(Object.entries(e).forEach(([e,t])=>{t&&t.classList.toggle("visible",e===a)}),"apache"===a||"mysql"===a){const t=e[a];if(!t.dataset.loaded){t.innerHTML='<div class="loader"><span class="spinner" role="img" aria-label="Loading"></span></div>';const e=`utils/${a}_inspector.php`;fetch(`${window.BASE_URL||"/"}${e}`).then(e=>e.text()).then(e=>{t.innerHTML=e,t.dataset.loaded="true"}).catch(n=>{t.innerHTML=`<p class="error">Failed to load ${e}</p>`,console.error(`[view.js] Failed to fetch ${e}`,n)})}}if(o){const e=window.BASE_URL||window.location.pathname,t="index"===a?"":"?view="+encodeURIComponent(n);history.pushState({},"",e+t)}}Object.entries({"toggle-index":"index","toggle-settings":"settings","toggle-phpinfo":"phpinfo","toggle-apache-inspector":"apache-inspector","toggle-mysql-inspector":"mysql-inspector"}).forEach(([e,t])=>{const n=document.getElementById(e);n&&n.addEventListener("click",e=>{e.preventDefault(),o(t,!0)})}),o(n()),window.addEventListener("popstate",()=>{o(n())})})})();
//# sourceMappingURL=script.min.js.map