(()=>{"use strict";function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function n(){var e=document.querySelector(".clock");if(e){var t=new Date;e.textContent=t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}}document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("restart-apache-button");e&&e.addEventListener("click",function(){return e="restart",void((t=document.getElementById("apache-status-message"))&&(t.innerText="Executing "+e+"...",fetch("".concat(window.BASE_URL,"utils/toggle_apache.php"),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"action="+encodeURIComponent(e)}).then(function(e){return e.text()}).then(function(e){try{var n=JSON.parse(e);t.innerText=n.message,"function"==typeof renderServerInfo&&renderServerInfo()}catch(n){console.error("Invalid JSON:",e),t.innerText="Error: Invalid server response"}}).catch(function(e){t.innerText="Error: "+e})));var e,t})});var o=new WeakSet;function r(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=document.querySelector(e);if(r&&!o.has(r)){o.add(r);var a=n.items||"li",i=n.handle||null,c=n.interactiveSelector||"input, select, textarea, button, a, [contenteditable], .no-drag",l=n.allowInsideHandle||"[data-drag-allow]",s=null===(t=n.allowHandleInteractive)||void 0===t||t,d=null,u=!1;r.addEventListener("pointerdown",function(e){var t=e.target.closest(a);if(t&&r.contains(t)){var n=!i||!!e.target.closest(i);if(!i||n){if(!!e.target.closest(c))if(!(s&&n&&e.target.closest(l)))return;t.draggable=!0}}},{capture:!0}),r.addEventListener("dragstart",function(e){var t=e.target.closest(a);if(t&&r.contains(t)){d=t,u=!0,e.dataTransfer.effectAllowed="move";try{e.dataTransfer.setData("text/plain","")}catch(e){}t.classList.add("dragElem")}}),r.addEventListener("dragenter",function(e){var t=e.target.closest(a);t&&r.contains(t)&&t.classList.add("over")}),r.addEventListener("dragover",function(e){d&&e.preventDefault()}),r.addEventListener("dragleave",function(e){var t=e.target.closest(a);t&&r.contains(t)&&t.classList.remove("over")}),r.addEventListener("drop",function(e){e.preventDefault();var t=e.target.closest(a);if(t&&d&&t!==d){var n=Array.from(r.querySelectorAll(":scope > ".concat(a))),o=n.indexOf(d),i=n.indexOf(t);o>-1&&i>-1&&(o<i?t.after(d):t.before(d),r.dispatchEvent(new CustomEvent("sorted",{bubbles:!0}))),t.classList.remove("over")}}),r.addEventListener("dragend",function(e){var t=e.target.closest(a);t&&r.contains(t)&&(t.classList.remove("dragElem"),t.draggable=!1),Array.from(r.querySelectorAll(a)).forEach(function(e){return e.classList.remove("over")}),d=null,u=!1}),r.addEventListener("click",function(e){u&&i&&e.target.closest(i)&&e.preventDefault()},!0)}}function a(e){localStorage.setItem("columnSize",e);var t=document.querySelector(".columns");t&&(t.classList.forEach(function(e){e.startsWith("max-")&&t.classList.remove(e)}),"auto"!==e&&t.classList.add(e))}function i(e,t){var n=localStorage.getItem("columnSize")||"auto",o=t.indexOf(n),r=0;"next"===e?r=(o+1)%t.length:"prev"===e&&(r=(o-1+t.length)%t.length),a(t[r])}function c(e){var t=e.sectionId,n=e.toggleButtonId,o=e.logElementId,r=e.endpoint;document.addEventListener("DOMContentLoaded",function(){var e=document.body;if(document.getElementById(t)){var a=document.getElementById(n),i=document.getElementById(o);a&&i&&(a.addEventListener("click",function(){var e=i.classList.contains("visible");i.classList.toggle("visible",!e),this.setAttribute("aria-expanded",!e)}),"true"===e.getAttribute("data-ajax-enabled")&&fetch("".concat(window.BASE_URL).concat(r),{cache:"no-store"}).then(function(e){return e.ok?e.text():Promise.reject()}).then(function(e){c(e),setInterval(l,3e3)}).catch(function(){}))}function c(e){var t=""===e.trim();i.innerHTML=t?'<code class="muted">No errors logged. You\'re doing great. üéâ</code>':"<code>".concat(e,"</code>")}function l(){fetch("".concat(window.BASE_URL).concat(r),{cache:"no-store"}).then(function(e){return e.ok?e.text():Promise.reject()}).then(c)}})}function l(){var e=document.getElementById("export-group"),t=document.getElementById("export-folder"),n=document.getElementById("uploads-mode-row"),o=document.getElementById("export-files-form"),r=document.getElementById("export-files-status"),a=document.getElementById("export-db-form"),i=document.getElementById("export-db"),c=document.getElementById("export-db-status");if(e&&t&&o&&a){var l=[];s(),fetch("".concat(window.BASE_URL,"utils/export_files.php?action=scan"),{credentials:"same-origin"}).then(function(e){return e.json()}).then(function(o){if(!o.ok)throw new Error(o.error||"Failed to scan folders");if(!(l=o.groups||[]).length)return e.innerHTML='<option value="">No folders defined</option>',e.disabled=!0,t.innerHTML='<option value="">No subfolders</option>',t.disabled=!0,r&&(r.innerHTML="No folders defined. Add entries to <code>config/folders.json</code> to enable file exports."),void(n&&(n.style.display="none"));!function(e,t){e.innerHTML="",t.forEach(function(t){var n=document.createElement("option");n.value=String(t.index),n.textContent=t.title,e.appendChild(n)})}(e,l),e.options.length&&e.dispatchEvent(new Event("change"))}).catch(function(n){console.error(n),e.innerHTML='<option value="">Error loading groups</option>',e.disabled=!0,t.innerHTML='<option value="">‚Äî</option>',t.disabled=!0}),fetch("".concat(window.BASE_URL,"utils/export_files.php?action=dbs"),{credentials:"same-origin"}).then(function(e){return e.json()}).then(function(e){if(!e.ok)throw new Error(e.error||"Failed to list databases");var t,n;t=i,n=e.databases||[],t.innerHTML="",n.length?n.forEach(function(e){var n=document.createElement("option");n.value=e,n.textContent=e,t.appendChild(n)}):t.innerHTML='<option value="">No databases found</option>'}).catch(function(e){console.error(e),i.innerHTML='<option value="">Error loading databases</option>'}),e.addEventListener("change",function(){var o=parseInt(e.value,10),r=Number.isNaN(o)?null:l[o];t.disabled=!0,t.innerHTML='<option value="">Select a group first‚Ä¶</option>',n&&(n.style.display="none");var a,i,c=document.querySelector('input[name="uploadsMode"][value="exclude"]');(c&&(c.checked=!0),r)&&(a=t,i=r.subfolders,a.innerHTML="",i.length?i.forEach(function(e){var t=document.createElement("option");t.value=e.name,t.textContent=e.name,a.appendChild(t)}):a.innerHTML='<option value="">No subfolders found</option>',t.disabled=0===r.subfolders.length,r.subfolders.length>0&&(t.selectedIndex=0,t.dispatchEvent(new Event("change"))))}),t.addEventListener("change",function(){var o=parseInt(e.value,10),r=Number.isNaN(o)?null:l[o];if(r){var a=r.subfolders.find(function(e){return e.name===t.value}),i=!!(a&&a.isWordPress&&a.hasUploads);n&&(n.style.display=i?"":"none");var c=document.querySelector('input[name="uploadsMode"][value="exclude"]');c&&(c.checked=!0)}}),o.addEventListener("submit",function(e){e.preventDefault(),r.textContent="Preparing archive‚Ä¶";var t=new FormData(o);t.append("action","zip"),t.append("engine",d()),fetch("".concat(window.BASE_URL,"utils/export_files.php"),{method:"POST",body:t,credentials:"same-origin"}).then(function(e){return e.json()}).then(function(e){if(!e.ok)throw new Error(e.error||"Export failed");var t='Done. <a href="'.concat(window.BASE_URL).concat(e.href,'" download="').concat(e.name,'">').concat(e.name,"</a>");return e.message&&(t+='<br><small class="muted">'.concat(e.message,"</small>")),r.innerHTML=t,window.location.href="".concat(window.BASE_URL).concat(e.href),s()}).catch(function(e){return console.error(e),r.textContent="Error: "+e.message,s()})}),a.addEventListener("submit",function(e){e.preventDefault(),c.textContent="Dumping database‚Ä¶";var t=new FormData(a);t.append("action","dumpdb"),t.append("engine",d()),fetch("".concat(window.BASE_URL,"utils/export_files.php"),{method:"POST",body:t,credentials:"same-origin"}).then(function(e){return e.json()}).then(function(e){if(!e.ok)throw new Error(e.error||"DB export failed");var t='Done. <a href="'.concat(window.BASE_URL).concat(e.href,'" download="').concat(e.name,'">').concat(e.name,"</a>");return e.message&&(t+='<br><small class="muted">'.concat(e.message,"</small>")),c.innerHTML=t,window.location.href="".concat(window.BASE_URL).concat(e.href),s()}).catch(function(e){return console.error(e),c.textContent="Error: "+e.message,s()})})}function s(){return fetch("".concat(window.BASE_URL,"utils/export_files.php?action=token"),{credentials:"same-origin"}).then(function(e){return e.json()}).then(function(e){e.ok&&e.token&&document.querySelectorAll('input[name="csrf"]').forEach(function(t){t.value=e.token})}).catch(function(){})}function d(){var e=document.querySelector('input[name="archiveEngine"]:checked');return e?e.value:"php"}}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,i,c=[],l=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=a.call(n)).done)&&(c.push(o.value),c.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw r}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.placeholder||"HTML Template",o="",r=!1,a=!1;function i(){return e.textContent.replace(/\u200B/g,"").replace(/\u00A0/g," ")}function c(e){var t=window.getSelection();if(!t.rangeCount)return null;var n=t.getRangeAt(0),o=n.cloneRange();o.selectNodeContents(e),o.setEnd(n.endContainer,n.endOffset);var r=e.textContent.length;return Math.min(o.toString().length,r)}function l(e,t){for(var n=window.getSelection(),o=document.createRange(),r=0,a=null,i=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);i.nextNode();){var c=i.currentNode,l=c.nodeValue.length;if(a=c,r+l>=t)return o.setStart(c,t-r),o.collapse(!0),n.removeAllRanges(),void n.addRange(o);r+=l}if(!a){var s=document.createTextNode("");e.appendChild(s),a=s}o.setStart(a,a.nodeValue.length),o.collapse(!0),n.removeAllRanges(),n.addRange(o)}function s(){r=!1;var a=i();if(a!==o){var s=c(e),d=a;d.endsWith("\n")&&!d.endsWith("\n‚Äã")&&(d+="‚Äã"),e.innerHTML=d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&lt;\/?[a-zA-Z][^&]*?&gt;/g,function(e){var t=e.slice(4,-4).trim(),n=!1,o=!1;t.startsWith("/")&&(n=!0,t=t.slice(1).trim()),t.endsWith("/")&&(o=!0,t=t.slice(0,-1).trim());var r=t.search(/\s/),a=(-1===r?t:t.slice(0,r)).toLowerCase(),i=-1===r?"":t.slice(r).trim();i=i.replace(/([a-zA-Z_:][-a-zA-Z0-9_:.]*)\s*(=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+))?/g,function(e,t,n){var o,r,a;if(!t)return e;if(!n)return'<span class="attr">'.concat(t,"</span>");var i=n.match(/^=\s*(?:"([^"]*)"|'([^']*)'|([^\s'">=]+))/);if(!i)return'<span class="attr">'.concat(t,"</span>").concat(n||"");var c=null!==(o=null!==(r=null!==(a=i[1])&&void 0!==a?a:i[2])&&void 0!==r?r:i[3])&&void 0!==o?o:"",l=i[1]?'"':i[2]?"'":"";return l?'<span class="attr">'.concat(t,'</span>=<span class="value">').concat(l).concat(c).concat(l,"</span>"):'<span class="attr">'.concat(t,'</span>=<span class="value">').concat(c,"</span>")});var c='<span class="pun">&lt;'.concat(n?"/":"","</span>"),l='<span class="tag">'.concat(a,"</span>"),s=i?" ".concat(i):"",d='<span class="pun">'.concat(o?" /":"","&gt;</span>");return"".concat(c).concat(l).concat(s).concat(d)}),e.hasAttribute("placeholder")||e.setAttribute("placeholder",n),a.length>0&&(!e.lastChild||e.lastChild.nodeType!==Node.TEXT_NODE)&&e.appendChild(document.createTextNode("")),null!=s&&l(e,s),o=a,t.onChange&&t.onChange(a)}}function d(t){if("insertFromPaste"===t.inputType&&t.clipboardData){t.preventDefault();var n=t.clipboardData.getData("text/plain").replace(/\r\n?/g,"\n");r=n,d=i(),u=null!==(a=c(e))&&void 0!==a?a:d.length,p=d.slice(0,u)+r+d.slice(u),e.textContent=p,l(e,u+r.length),o="",s()}var r,a,d,u,p}function u(t){if("Escape"!==t.key)if("Tab"===t.key&&a)a=!1;else{if("Tab"===t.key){t.preventDefault();var n=i(),r=c(e),d=n;return t.shiftKey?"\t"===n.slice(r-1,r)?(d=n.slice(0,r-1)+n.slice(r),r-=1):"  "===n.slice(r-2,r)&&(d=n.slice(0,r-2)+n.slice(r),r-=2):(d=n.slice(0,r)+"\t"+n.slice(r),r+=1),e.textContent=d,l(e,r),o="",void s()}if("Enter"===t.key&&!t.shiftKey){var u=i();if(0===u.length)return;t.preventDefault();var p=c(e),f="\n"+((u.slice(0,p).split(/\r?\n/).pop()||"").match(/^[\t ]+/)||[""])[0],m=u.slice(0,p)+f+u.slice(p),v=p+f.length;m===u&&(m=u+f,v=u.length+f.length),e.textContent=m,e.focus(),l(e,v),o="",s()}}else a=!0}function p(n){return/^[\s\u200B]*$/.test(e.textContent)&&((n.inputType||"").startsWith("delete")||"deleteByCut"===n.inputType)?(e.innerHTML="",o="",void(t.onChange&&t.onChange(""))):"insertParagraph"===n.inputType||"insertFromPaste"===n.inputType||"insertFromDrop"===n.inputType||"historyUndo"===n.inputType||"historyRedo"===n.inputType?(o="",void s()):void(r||(r=!0,requestAnimationFrame(function(){try{s()}finally{r=!1}})))}function f(){a=!1,s()}return e.setAttribute("contenteditable","true"),e.setAttribute("role","textbox"),e.setAttribute("aria-multiline","true"),e.setAttribute("aria-label",n),e.setAttribute("aria-describedby",t.describedBy||"editor-instructions"),e.setAttribute("placeholder",n),e.setAttribute("spellcheck","false"),e.setAttribute("autocomplete","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("autocorrect","off"),e.addEventListener("beforeinput",d),e.addEventListener("keydown",u),e.addEventListener("input",p),e.addEventListener("blur",f),s(),{getValue:function(){return i()},setValue:function(t){e.textContent=t||"",o="",s()},destroy:function(){e.removeEventListener("beforeinput",d),e.removeEventListener("keydown",u),e.removeEventListener("input",p),e.removeEventListener("blur",f)}}}function f(){var e,t=(null===(e=document.querySelector(".search-bar"))||void 0===e?void 0:e.value.toLowerCase())||"";document.querySelectorAll(".folders li").forEach(function(e){var n=e.textContent.toLowerCase();e.style.display=n.includes(t)?"":"none"})}var m=["theme","columnOrder","columnSize","accordion_"];function v(e){var t=document.documentElement;t.className=t.className.split(/\s+/).filter(function(e){return e&&!e.endsWith("-theme")}).join(" "),"default"!==e&&t.classList.add("".concat(e,"-theme"));var n="dark";document.body.classList.contains("dark-mode")||(document.body.classList.remove("light-mode"),document.body.classList.add("dark-mode")),"undefined"!=typeof themeTypes&&"light"===themeTypes[e]&&(n="light",document.body.classList.contains("light-mode")||(document.body.classList.remove("dark-mode"),document.body.classList.add("light-mode")));var o=document.querySelector('meta[name="color-scheme" ]');o||((o=document.createElement("meta")).setAttribute("name","color-scheme"),document.head.appendChild(o)),o.getAttribute("content")!==n&&o.setAttribute("content",n)}function h(){document.querySelectorAll("[data-generate-cert]").forEach(function(e){e.addEventListener("click",function(){var t=e.dataset.generateCert;confirm("Generate a new SSL certificate for "+t+"?")&&fetch("".concat(window.BASE_URL,"utils/generate_cert.php?name=").concat(encodeURIComponent(t))).then(function(e){return e.text()}).then(function(e){if(alert(e),e.includes("successfully")){var t=document.getElementById("restart-apache");t&&t.click()}}).catch(function(){return alert("Failed to run cert script.")})})})}function g(){var e=document.getElementById("vhost-filter"),t=document.querySelectorAll("#vhosts-table tbody tr");e&&t.length&&e.addEventListener("change",function(){var n=e.value,o=0;t.forEach(function(e){var t=e.classList.contains("vhost-ssl"),r=e.classList.contains("cert-valid"),a=e.classList.contains("host-valid"),i=!0;"missing-cert"===n?i=!r:"missing-host"===n?i=!a:"ssl-only"===n?i=t:"non-ssl"===n&&(i=!t),e.style.display=i?"":"none",i&&o++});var r=document.getElementById("vhost-empty-msg");r&&(r.style.display=0===o?"":"none")})}function y(){document.addEventListener("click",function(e){if(e.target.matches(".open-folder")){var t=e.target.dataset.path.replace(/^"(.*)"$/,"$1");t&&fetch("".concat(window.BASE_URL,"utils/open_folder.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:t})})}})}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,i,c=[],l=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=a.call(n)).done)&&(c.push(o.value),c.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw r}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return L(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}document.addEventListener("DOMContentLoaded",function(){n(),setInterval(n,1e3)}),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector(".columns");if(e){var t=["max-xs","max-sm","max-md","max-lg"],n=localStorage.getItem("columnSize");n&&t.includes(n)&&a(n);var o=document.getElementById("reset-width"),c=document.getElementById("prev-width"),l=document.getElementById("next-width");o&&o.addEventListener("click",function(){return a("auto")}),c&&c.addEventListener("click",function(){return i("prev",t)}),l&&l.addEventListener("click",function(){return i("next",t)});var s=JSON.parse(localStorage.getItem("columnOrder")||"[]");Array.isArray(s)&&s.length&&s.forEach(function(t){var n=document.getElementById(t);n&&n.classList.contains("column")&&!n.classList.contains("column-controls")&&e.appendChild(n)}),r(".columns",{items:".column:not(.column-controls)",handle:".drag-handle"}),e.addEventListener("sorted",function(){var t=Array.from(e.querySelectorAll(":scope > .column:not(.column-controls)")).map(function(e){return e.id}).filter(Boolean);localStorage.setItem("columnOrder",JSON.stringify(t))})}}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("dock-list"),t=document.getElementById("add-dock-item"),n=document.querySelector("#settings-view form");function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=document.createElement("li");n.className="dock-item",n.innerHTML='\n\t\t\t\t<input type="text" placeholder="Label" value="'.concat(t.label||"",'">\n\t\t\t\t<input type="text" placeholder="URL" value="').concat(t.url||"",'">\n\t\t\t\t<input type="text" placeholder="Icon" value="').concat(t.icon||"",'">\n\t\t\t\t<input type="text" placeholder="Alt Text" value="').concat(t.alt||"",'">\n\t\t\t\t<button type="button" class="remove-dock-item">‚ùå</button>\n\t\t\t'),e.appendChild(n),n.querySelector(".remove-dock-item").addEventListener("click",function(){n.remove(),a()}),Array.from(n.querySelectorAll("input")).forEach(function(e){e.addEventListener("input",a)})}function a(){var t=[];Array.from(e.children).forEach(function(e){var n=e.querySelectorAll("input");n.length<4||t.push({label:n[0].value.trim(),url:n[1].value.trim(),icon:n[2].value.trim(),alt:n[3].value.trim()})});var n=document.getElementById("dock_json_input");n&&(n.value=JSON.stringify(t,null,2))}e&&t&&n&&(fetch("".concat(window.BASE_URL,"utils/read_config.php?file=dock"),{cache:"no-store"}).then(function(e){return e.json()}).then(function(t){t.forEach(o),r("#dock-list"),e.addEventListener("sorted",a),a()}),t.addEventListener("click",function(){o(),r("#dock-list"),a()}))}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("folders-config-list"),t=document.getElementById("add-folder-column"),n=document.getElementById("folders_json_input");if(e&&t&&n){var o=[],a='<option value="">(none)</option>',i=!1,c=null;e.addEventListener("input",function(e){e.target.matches('input[type="text"], select')&&f()}),e.addEventListener("change",function(e){e.target.matches('select, input[type="checkbox"]')&&f()}),e.addEventListener("click",function(e){if(e.target.closest(".add-special")){var t,n=null===(t=e.target.closest(".folder-config-item"))||void 0===t?void 0:t.querySelector(".special-cases");n&&(n.insertAdjacentHTML("beforeend",l()),f())}if(e.target.closest(".remove-special")){var o=e.target.closest(".special-case");o&&(o.remove(),f())}if(e.target.closest(".remove-folder-column")){var r=e.target.closest(".folder-config-item");r&&(r.remove(),f())}}),e.addEventListener("sorted",function(){i=!0,m()}),Promise.all([fetch("".concat(window.BASE_URL,"utils/read_config.php?file=folders"),{cache:"no-store"}).then(function(e){return e.json()}).catch(function(){return[]}),Array.isArray(window.LINK_TEMPLATES)?(o=window.LINK_TEMPLATES.map(function(e){return e&&"string"==typeof e.name?e.name.trim():""}).filter(Boolean),o=Array.from(new Set(o)),a='<option value="">(none)</option>'+o.map(function(e){return'<option value="'.concat(e,'">').concat(e,"</option>")}).join(""),Promise.resolve(o)):fetch("".concat(window.BASE_URL,"utils/read_config.php?file=link_templates"),{cache:"no-store"}).then(function(e){return e.json()}).then(function(e){return o=(Array.isArray(e)?e:[]).map(function(e){return e&&"string"==typeof e.name?e.name.trim():""}).filter(Boolean),o=Array.from(new Set(o)),a='<option value="">(none)</option>'+o.map(function(e){return'<option value="'.concat(e,'">').concat(e,"</option>")}).join(""),o}).catch(function(){return a='<option value="">(none)</option>',o=[]})]).then(function(t){var n,a,c,l=s(t,1)[0];r("#folders-config-list"),Array.isArray(l)&&l.length&&(n=l,a=document.createDocumentFragment(),(c=document.createElement("div")).innerHTML=n.map(d).join(""),Array.from(c.children).forEach(function(e){return a.appendChild(e)}),e.appendChild(a),e.querySelectorAll(".folder-config-item").forEach(function(e){var t=e.querySelector(".link-template-select");if(t){var r,a=(null===(r=e.querySelector('input[data-key="title"]'))||void 0===r?void 0:r.value)||"",i=n.find(function(e){return(e.title||"")===a}),c=(null==i?void 0:i.linkTemplate)||"";c&&(t.value=c),t.disabled=0===o.length}})),0===e.children.length&&p({}),i=!0,m()}),t.addEventListener("click",function(){p({})})}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.match||"",n=e.replace||"";return'\n\t\t\t\t<div class="special-case">\n\t\t\t\t\t<input type="text" class="sc-match" placeholder="Match Regex" value="'.concat(t,'">\n\t\t\t\t\t<input type="text" class="sc-replace" placeholder="Replace Regex" value="').concat(n,'">\n\t\t\t\t\t<button type="button" class="remove-special">‚úñ</button>\n\t\t\t\t</div>\n\t\t\t')}function d(){var e,t,n,o,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=(r=i.specialCases,r&&"object"===u(r)&&!Array.isArray(r)?Object.entries(r).map(function(e){var t=s(e,2),n=t[0],o=t[1];return{match:String(null!=n?n:""),replace:String(null!=o?o:"")}}):[]).map(l).join("");return i.linkTemplate,'\n\t\t\t\t<li class="folder-config-item">\n\t\t\t\t\t<input type="text" data-key="title" placeholder="Title" value="'.concat(i.title||"",'">\n\t\t\t\t\t<input type="text" data-key="href" placeholder="Href (optional)" value="').concat(i.href||"",'">\n\t\t\t\t\t<input type="text" data-key="dir" placeholder="Dir (relative to HTDOCS_PATH)" value="').concat(i.dir||"",'">\n\t\t\t\t\t<input type="text" data-key="excludeList" placeholder="Exclude List (comma-separated)" value="').concat((i.excludeList||[]).join(","),'">\n\t\t\t\t\t<input type="text" data-key="match" placeholder="Match Regex" value="').concat(null!==(e=null===(t=i.urlRules)||void 0===t?void 0:t.match)&&void 0!==e?e:"",'">\n\t\t\t\t\t<input type="text" data-key="replace" placeholder="Replace Regex" value="').concat(null!==(n=null===(o=i.urlRules)||void 0===o?void 0:o.replace)&&void 0!==n?n:"",'">\n\t\t\t\t\t<label>Link Template:\n\t\t\t\t\t\t<select class="link-template-select" name="linkTemplate">').concat(a,'</select>\n\t\t\t\t\t</label>\n\t\t\t\t\t<label><input type="checkbox" class="disable-links"').concat(i.disableLinks?" checked":"",'> Disable Links</label>\n\n\t\t\t\t\t<div class="special-cases-wrapper">\n\t\t\t\t\t\t<label>Special Cases:</label>\n\t\t\t\t\t\t<div class="special-cases">').concat(c,'</div>\n\t\t\t\t\t\t<button type="button" class="add-special">‚ûï Add Rule</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<button type="button" class="remove-folder-column">‚ùå</button>\n\t\t\t\t</li>\n\t\t\t')}function p(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=document.createElement("div");n.innerHTML=d(t);var r=n.firstElementChild;e.appendChild(r);var a=r.querySelector(".link-template-select");a&&(a.disabled=0===o.length,t.linkTemplate&&(a.value=t.linkTemplate)),f()}function f(){i=!0,c&&clearTimeout(c),c=setTimeout(m,120)}function m(){var t;c=null,i&&(n.value=JSON.stringify((t=[],e.querySelectorAll(".folder-config-item").forEach(function(e){var n,o,r,a,i,c,l,s,d=function(t){return e.querySelector(t)},u=(null===(n=d('input[data-key="title"]'))||void 0===n?void 0:n.value.trim())||"",p=(null===(o=d('input[data-key="href"]'))||void 0===o?void 0:o.value.trim())||"",f=(null===(r=d('input[data-key="dir"]'))||void 0===r?void 0:r.value.trim())||"",m=(null===(a=d('input[data-key="excludeList"]'))||void 0===a?void 0:a.value)||"",v=(null===(i=d('input[data-key="match"]'))||void 0===i?void 0:i.value)||"",h=(null===(c=d('input[data-key="replace"]'))||void 0===c?void 0:c.value)||"",g=(null===(l=e.querySelector(".link-template-select"))||void 0===l?void 0:l.value)||"",y=!(null===(s=e.querySelector(".disable-links"))||void 0===s||!s.checked),E=[];e.querySelectorAll(".special-case").forEach(function(e){var t,n,o=(null===(t=e.querySelector(".sc-match"))||void 0===t?void 0:t.value)||"",r=(null===(n=e.querySelector(".sc-replace"))||void 0===n?void 0:n.value)||"";(o.length||r.length)&&E.push({match:o,replace:r})});var L,b=(L={},E.forEach(function(e){var t=e.match,n=void 0===t?"":t,o=e.replace,r=void 0===o?"":o,a=String(n).trim(),i=String(r).trim();(a.length||i.length)&&(L[a]=i)}),L),S=m.split(",").map(function(e){return e.trim()}).filter(Boolean),x={title:u,href:p,dir:f,excludeList:S,urlRules:{match:v,replace:h},linkTemplate:g,disableLinks:y,specialCases:b};(u||p||f||S.length||v||h||g||y||Object.keys(b).length)&&t.push(x)}),t),null,2),i=!1)}}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("link-templates-list"),t=document.getElementById("add-link-template"),n="HTML Template";function o(){var t=[];e.querySelectorAll(".template-item").forEach(function(e){var n,o,r=null===(n=e.querySelector(".template-name"))||void 0===n?void 0:n.value.trim(),a="";a=(a=(null===(o=e.querySelector(".template-html"))||void 0===o?void 0:o.textContent)||"").replace(/\u200B/g,""),r&&a&&t.push({name:r,html:a})});var n=document.getElementById("link_templates_json_input");n&&(n.value=JSON.stringify(t,null,2))}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=document.createElement("li");r.className="template-item";var a="";a='\n\t\t\t\t\t<div class="template-html-wrapper">\n\t\t\t\t\t\t<pre class="template-html syntax-highlight"\n\t\t\t\t\t\t\trole="textbox" aria-multiline="true" aria-label="HTML Template"\n\t\t\t\t\t\t\tplaceholder="'.concat(n,'"></pre>\n\t\t\t\t\t</div>'),r.innerHTML='\n\t\t\t\t<input type="text" class="template-name" placeholder="Template Name" value="'.concat(t.name||"",'">\n\t\t\t\t').concat(a,'\n\t\t\t\t<button type="button" class="remove-template">‚ùå</button>\n\t\t\t');var i=null,c=r.querySelector(".template-html");c.textContent=t.html||"",i=p(c,{placeholder:n,onChange:o}),r.querySelector(".remove-template").addEventListener("click",function(){i&&"function"==typeof i.destroy&&i.destroy(),r.remove(),o()}),r.querySelector(".template-name").addEventListener("input",o),e.appendChild(r),o()}e&&t&&(t.addEventListener("click",function(){return r()}),e.innerHTML="",fetch("".concat(window.BASE_URL,"utils/read_config.php?file=link_templates"),{cache:"no-store"}).then(function(e){return e.json()}).then(function(e){(Array.isArray(e)?e:Array.isArray(null==e?void 0:e.templates)?e.templates:[]).forEach(r),o()}).catch(function(){return o()}))}),c({sectionId:"apache-error-log-section",toggleButtonId:"toggle-apache-error-log",logElementId:"apache-error-log",endpoint:"utils/apache_error_log.php"}),c({sectionId:"php-error-log-section",toggleButtonId:"toggle-php-error-log",logElementId:"php-error-log",endpoint:"utils/php_error_log.php"}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){return l()}):l(),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector(".search-bar");e&&e.addEventListener("input",f)}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("clear-local-storage");e&&e.addEventListener("click",function(){confirm("Are you sure you want to reset saved UI settings?")&&(Object.keys(localStorage).filter(function(e){return m.some(function(t){return e.startsWith(t)})}).forEach(function(e){return localStorage.removeItem(e)}),alert("Saved settings have been cleared from local storage."),location.reload())})}),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector(".post-confirmation-container");e&&setTimeout(function(){e.style.transition="opacity 0.5s ease",e.style.opacity="0",setTimeout(function(){return e.remove()},500)},3e3)}),document.addEventListener("DOMContentLoaded",function(){var e=document.body;if(document.getElementById("system-monitor")&&"true"===e.getAttribute("data-ajax-enabled")){var t=document.getElementById("cpu-load"),n=document.getElementById("memory-usage"),o=document.getElementById("disk-space");fetch("".concat(window.BASE_URL,"utils/system_stats.php"),{cache:"no-store"}).then(function(e){if(e.ok)return e.json()}).then(function(e){t.textContent="".concat(e.cpu,"%"),n.textContent="".concat(e.memory," MB"),o.textContent="".concat(e.disk,"%"),setInterval(r,1e3),r()}).catch(function(){})}function r(){fetch("".concat(window.BASE_URL,"utils/system_stats.php"),{cache:"no-store"}).then(function(e){if(!e.ok)throw new Error("System stats unavailable");return e.json()}).then(function(e){t.textContent="".concat(e.cpu,"%"),n.textContent="".concat(e.memory," MB"),o.textContent="".concat(e.disk,"%")})}}),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector("#theme-selector");if(e){var t=localStorage.getItem("theme")||("undefined"!=typeof serverTheme?serverTheme:"default");v(t),e.value=t,e.addEventListener("change",function(e){var t=e.target.value;v(t),localStorage.setItem("theme",t)})}}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){h(),g(),y()}):(h(),g(),y()),function(){function t(e){e.offsetHeight}function n(t){var n=getComputedStyle(t),o=function(e){return e.split(",").map(function(e){return parseFloat(e)||0})},r=Math.max.apply(Math,e(o(n.transitionDuration))),a=Math.max.apply(Math,e(o(n.transitionDelay)));return Math.round(1e3*(r+a))||0}document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".toggle-content-container").forEach(function(e,o){if("1"!==e.dataset.accordionInit){e.dataset.accordionInit="1";var r=e.querySelector(".toggle-accordion"),a=e.querySelector(".toggle-content");if(r&&a){var i=parseInt(a.dataset.collapsedHeight)||0,c=e.dataset.id||"accordion-"+o,l=0,s=0,d=null,u="open"===localStorage.getItem("accordion_"+c);f(u),u?(a.hidden=!1,a.style.height=a.scrollHeight+"px",requestAnimationFrame(function(){a.style.height="auto"})):(a.style.height=i+"px",a.hidden=!0),r.addEventListener("click",function(e){var t;(e.stopPropagation(),t=".tooltip-icon",e.target.closest(t))||h()}),r.addEventListener("keydown",function(t){if(" "===t.key||"Enter"===t.key)t.preventDefault(),h();else if("ArrowDown"===t.key&&e.classList.contains("open")&&!a.hidden){var n=a.querySelector('a,button,input,select,textarea,[tabindex]:not([tabindex="-1"])');n&&n.focus()}})}}function p(){d&&(a.removeEventListener("transitionend",d),d=null),s&&(clearTimeout(s),s=0)}function f(t){e.classList.toggle("open",t),r.setAttribute("aria-expanded",t?"true":"false"),localStorage.setItem("accordion_"+c,t?"open":"closed")}function m(e){e===l&&(a.style.height="auto")}function v(e){e===l&&(a.hidden=!0)}function h(){var o,r=!e.classList.contains("open");r&&a.hidden&&(a.hidden=!1),r?(o=++l,p(),a.hidden=!1,f(!0),a.style.height=i+"px",t(a),requestAnimationFrame(function(){if(o===l){var e=a.scrollHeight;a.style.height=e+"px",d=function(e){e.target===a&&"height"===e.propertyName&&(p(),m(o))},a.addEventListener("transitionend",d);var t=n(a);t>0&&(s=setTimeout(function(){p(),m(o)},t+40))}})):function(){var e=++l;p(),f(!1),a.style.height=a.scrollHeight+"px",t(a),requestAnimationFrame(function(){if(e===l){a.style.height=i+"px",d=function(t){t.target===a&&"height"===t.propertyName&&(p(),v(e))},a.addEventListener("transitionend",d);var t=n(a);t>0&&(s=setTimeout(function(){p(),v(e)},t+40))}})}(),requestAnimationFrame(function(){e.classList.contains("open")&&a.hidden&&(a.hidden=!1)})}}),window.addEventListener("resize",function(){document.querySelectorAll(".toggle-content-container.open .toggle-content").forEach(function(e){e.hidden&&(e.hidden=!1),"auto"!==e.style.height&&(e.style.height=e.scrollHeight+"px")})})})}(),document.addEventListener("DOMContentLoaded",function(){var e={index:document.getElementById("folders-view"),settings:document.getElementById("settings-view"),phpinfo:document.getElementById("phpinfo-view"),apache:document.getElementById("apache-view"),mysql:document.getElementById("mysql-view")},t={index:"index",settings:"settings",phpinfo:"phpinfo","apache-inspector":"apache","mysql-inspector":"mysql"};function n(){return new URLSearchParams(window.location.search).get("view")||"index"}function o(n){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t[n]||"index";if(Object.entries(e).forEach(function(e){var t=E(e,2),n=t[0],o=t[1];o&&o.classList.toggle("visible",n===r)}),"apache"===r||"mysql"===r){var a=e[r];if(a&&!a.dataset.loaded){a.innerHTML='<div class="loader"><span class="spinner" role="img" aria-label="Loading"></span></div>';var i="utils/".concat(r,"_inspector.php");fetch("".concat(window.BASE_URL||"/").concat(i)).then(function(e){return e.text()}).then(function(e){a.innerHTML=e,a.dataset.loaded="true"}).catch(function(e){a.innerHTML='<p class="error">Failed to load '.concat(i,"</p>"),console.error("[view.js] Failed to fetch ".concat(i),e)})}}if(o){var c=window.BASE_URL||window.location.pathname,l="index"===r?"":"?view="+encodeURIComponent(n);history.pushState({},"",c+l)}}Object.entries({"toggle-index":"index","toggle-settings":"settings","toggle-phpinfo":"phpinfo","toggle-apache-inspector":"apache-inspector","toggle-mysql-inspector":"mysql-inspector"}).forEach(function(e){var t=E(e,2),n=t[0],r=t[1],a=document.getElementById(n);a&&a.addEventListener("click",function(e){e.preventDefault(),o(r,!0)})}),o(n()),window.addEventListener("popstate",function(){o(n())})})})();
//# sourceMappingURL=script.min.js.map